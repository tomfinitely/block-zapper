(()=>{"use strict";var e,o={792:()=>{const e=window.wp.blocks,o=window.wp.i18n,t=window.wp.blockEditor,s=window.wp.components,r=window.wp.data,l=window.wp.element,a=window.ReactJSXRuntime,n=JSON.parse('{"UU":"telex/block-zapper"}');(0,e.registerBlockType)(n.UU,{edit:function(n){var i,c,p,d,m,u,h;const{clientId:b,attributes:k,setAttributes:g}=n,f=(0,t.useBlockProps)(),[v,x]=(0,l.useState)(!1),[y,C]=(0,l.useState)(""),[A,w]=(0,l.useState)(null),[z,S]=(0,l.useState)("selective"),[E,j]=(0,l.useState)({blockSettings:null===(i=k.zapBlockSettings)||void 0===i||i,blockStyles:null===(c=k.zapBlockStyles)||void 0===c||c,customProperties:null===(p=k.zapCustomProperties)||void 0===p||p,keepMedia:null===(d=k.zapKeepMedia)||void 0===d||d,customClasses:null===(m=k.zapCustomClasses)||void 0===m||m,customAnchors:null===(u=k.zapCustomAnchors)||void 0===u||u,htmlElements:null===(h=k.zapHtmlElements)||void 0===h||h}),{updateBlockAttributes:M,replaceBlock:P}=(0,r.useDispatch)("core/block-editor"),B=(0,r.useSelect)(e=>{try{const o=e("core/block-editor").getBlocks(b);return Array.isArray(o)?o:[]}catch(e){return console.error("Error getting inner blocks:",e),[]}},[b]);(0,l.useEffect)(()=>{if(y){const e=setTimeout(()=>{C("")},1e4);return()=>clearTimeout(e)}},[y]),(0,l.useEffect)(()=>{g({zapBlockSettings:E.blockSettings,zapBlockStyles:E.blockStyles,zapCustomProperties:E.customProperties,zapKeepMedia:E.keepMedia,zapCustomClasses:E.customClasses,zapCustomAnchors:E.customAnchors,zapHtmlElements:E.htmlElements})},[E,g]);const O=e=>e&&"object"==typeof e&&e.attributes||{},Z=(o,t=!1,s=!0)=>{if(!o||!o.name)return console.warn("Invalid block passed to createCleanBlock:",o),null;const r=O(o),{cleanedAttributes:l,removedAttributes:a}=((e,o=!1,t=!0)=>{const s={essential:["content","url","alt","caption","href","text","level","tagName","value","label","placeholder","title","type","checked","selected","disabled","required","multiple","name","id","headers","scope"],media:["src","poster","preload","autoplay","controls","loop","muted","playsInline","crossOrigin","sizeSlug","blob","mediaId","mediaType","focalPoint","hasParallax","isRepeated","minHeight","minHeightUnit","aspectRatio","width","height","scale"],blockSettings:["orientation","verticalAlignment","templateLock","allowedBlocks","layout","templateInsertUpdatesSelection"],blockStyles:["backgroundColor","textColor","customBackgroundColor","customTextColor","gradient","customGradient","overlayColor","customOverlayColor"],customProperties:["fontSize","customFontSize","fontFamily","fontStyle","fontWeight","letterSpacing","textDecoration","textTransform","lineHeight","style","margin","padding","blockGap","borderColor","customBorderColor","borderRadius","borderWidth","borderStyle","shadow","filter","position","zIndex","top","right","bottom","left"],customClasses:["className"],customAnchors:["anchor"],htmlElements:["align","nodeName"]};if(o){console.log("MEGA ZAP MODE - Starting with keepMedia:",t);const o=new Set,r=new Set;s.essential.forEach(t=>{e.hasOwnProperty(t)&&o.add(t)}),t&&s.media.forEach(t=>{e.hasOwnProperty(t)&&(o.add(t),console.log(`MEGA ZAP: Preserving media attribute: ${t}`))}),Object.keys(e).forEach(e=>{o.has(e)||(r.add(e),console.log(`MEGA ZAP: Will remove attribute: ${e}`))});const l={},a=[];return Object.keys(e).forEach(t=>{o.has(t)?l[t]=e[t]:a.push(t)}),console.log("MEGA ZAP FINAL RESULT:",{keepMedia:t,originalCount:Object.keys(e).length,keptCount:Object.keys(l).length,removedCount:a.length,keptAttributes:Object.keys(l),removedAttributes:a,mediaAttributesFound:s.media.filter(o=>e.hasOwnProperty(o)),mediaAttributesKept:s.media.filter(e=>l.hasOwnProperty(e)),mediaAttributesRemoved:s.media.filter(e=>a.includes(e))}),{cleanedAttributes:l,removedAttributes:a}}const r=new Set(s.essential);t&&s.media.forEach(e=>r.add(e));const l=new Set;E.blockSettings&&s.blockSettings.forEach(e=>{t&&s.media.includes(e)||l.add(e)}),E.blockStyles&&s.blockStyles.forEach(e=>{t&&s.media.includes(e)||l.add(e)}),E.customProperties&&s.customProperties.forEach(e=>{t&&s.media.includes(e)||l.add(e)}),E.customClasses&&s.customClasses.forEach(e=>l.add(e)),E.customAnchors&&s.customAnchors.forEach(e=>l.add(e)),E.htmlElements&&s.htmlElements.forEach(e=>l.add(e));const a={},n=[];return Object.keys(e).forEach(o=>{l.has(o)&&!r.has(o)?n.push(o):a[o]=e[o]}),console.log("SELECTIVE ZAP debug:",{isMegaZap:o,keepMedia:t,zapOptions:E,originalAttributeCount:Object.keys(e).length,toKeepCount:r.size,toRemoveCount:l.size,cleanedAttributeCount:Object.keys(a).length,removedAttributeCount:n.length,mediaAttributesKept:s.media.filter(o=>e.hasOwnProperty(o)&&!l.has(o)),mediaAttributesRemoved:s.media.filter(o=>e.hasOwnProperty(o)&&l.has(o))}),{cleanedAttributes:a,removedAttributes:n}})(r,t,s),n=[];Array.isArray(o.innerBlocks)&&o.innerBlocks.forEach(e=>{const o=Z(e,t,s);o&&o.cleanBlock&&n.push(o.cleanBlock)});try{return{cleanBlock:(0,e.createBlock)(o.name,l,n),removedAttributes:a}}catch(e){return console.error(`Error creating clean block for ${o.name}:`,e),null}},T=(e,o)=>{j(t=>({...t,[e]:o}))},R=Array.isArray(B)?B.reduce((e,o)=>{const t=O(o);return e+Object.keys(t).length},0):0,_=Array.isArray(B)?B.length:0,I=E.blockSettings||E.blockStyles||E.customProperties||E.customClasses||E.customAnchors||E.htmlElements,L="mega"===z?{label:v?(0,o.__)("üí• MEGA ZAPPING...","block-zapper-block-wp"):(0,o.__)("üí• MEGA ZAP!","block-zapper-block-wp"),color:"#dd0000",hoverColor:"#bb0000",activeColor:"#990000",disabled:v||0===_}:{label:v?(0,o.__)("‚ö° SELECTIVE ZAPPING...","block-zapper-block-wp"):(0,o.__)("‚ö° SELECTIVE ZAP!","block-zapper-block-wp"),color:I?"#ff4444":"#ccc",hoverColor:"#cc3333",activeColor:"#aa2222",disabled:v||0===_||!I};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.InspectorControls,{children:(0,a.jsxs)(s.PanelBody,{title:(0,o.__)("‚ö° Block Zapper Controls","block-zapper-block-wp"),initialOpen:!0,children:[(0,a.jsx)(s.Card,{children:(0,a.jsx)(s.CardBody,{children:(0,a.jsxs)("div",{style:{marginBottom:"16px",fontSize:"14px"},children:[(0,a.jsx)("strong",{children:"üì¶ Container Status:"}),(0,a.jsx)("br",{}),"üß± ",_," block(s) inside",(0,a.jsx)("br",{}),"üî¢ ",R," total properties",A&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("br",{}),"üïê Last zap: ",A]})]})})}),(0,a.jsx)("div",{style:{margin:"16px 0"},children:(0,a.jsx)(s.RadioControl,{label:(0,o.__)("üéØ Zap Mode","block-zapper-block-wp"),help:"mega"===z?(0,o.__)("Nuclear option: removes ALL styling, keeps only content + media (if selected)","block-zapper-block-wp"):(0,o.__)("Choose specific types of properties to remove with granular control","block-zapper-block-wp"),selected:z,options:[{label:"‚ö° Selective Zap (choose what to remove)",value:"selective"},{label:"üí• Mega Zap (nuclear option)",value:"mega"}],onChange:S})}),"selective"===z&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"zapper-media-option",style:{marginBottom:"16px",padding:"12px",backgroundColor:"#f8f9fa",border:"1px solid #e2e4e7",borderRadius:"4px"},children:(0,a.jsx)(s.CheckboxControl,{label:"üì∏ Keep images and videos (recommended)",checked:E.keepMedia,onChange:e=>T("keepMedia",e),help:"Preserves media sources and related attributes"})}),(0,a.jsx)("h4",{style:{margin:"16px 0 8px 0",fontSize:"14px",fontWeight:"600"},children:"Choose What to Zap:"}),(0,a.jsx)(s.CheckboxControl,{label:"‚öôÔ∏è Block settings (layout, alignment, etc.)",checked:E.blockSettings,onChange:e=>T("blockSettings",e),help:"Removes core block functionality settings"}),(0,a.jsx)(s.CheckboxControl,{label:"üé® Block styles (colors, gradients, backgrounds)",checked:E.blockStyles,onChange:e=>T("blockStyles",e),help:"Removes color and gradient styling"}),(0,a.jsx)(s.CheckboxControl,{label:"üîß Custom properties (fonts, spacing, borders, effects)",checked:E.customProperties,onChange:e=>T("customProperties",e),help:"Removes typography, margin, padding, borders, shadows"}),(0,a.jsx)(s.CheckboxControl,{label:"üìù Custom classes (Additional CSS class(es))",checked:E.customClasses,onChange:e=>T("customClasses",e),help:"Removes custom CSS classes from Advanced panel"}),(0,a.jsx)(s.CheckboxControl,{label:"‚öì Custom anchors (HTML anchor)",checked:E.customAnchors,onChange:e=>T("customAnchors",e),help:"Removes HTML anchor IDs from Advanced panel"}),(0,a.jsx)(s.CheckboxControl,{label:"üè∑Ô∏è HTML element selections (alignment, tags)",checked:E.htmlElements,onChange:e=>T("htmlElements",e),help:"Removes alignment and HTML element choices"})]}),"mega"===z&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:{padding:"16px",backgroundColor:"#fff3cd",border:"1px solid #ffeaa7",borderRadius:"4px",margin:"16px 0"},children:[(0,a.jsx)("h4",{style:{margin:"0 0 8px 0",fontSize:"14px",fontWeight:"600",color:"#856404"},children:"üí• Mega Zap Mode"}),(0,a.jsxs)("p",{style:{margin:"0",fontSize:"13px",color:"#856404"},children:[(0,a.jsx)("strong",{children:"Warning:"})," This will remove ALL styling properties and customizations from blocks, keeping only essential content."]})]}),(0,a.jsx)("div",{className:"zapper-media-option zapper-mega-media-option",style:{padding:"12px",backgroundColor:"#f8f9fa",border:"1px solid #e2e4e7",borderRadius:"4px",marginTop:"16px"},children:(0,a.jsx)(s.CheckboxControl,{label:"üì∏ Keep images and videos (recommended)",checked:E.keepMedia,onChange:e=>T("keepMedia",e),help:"Preserves media sources and related attributes during mega zap"})})]}),(0,a.jsxs)("div",{style:{marginTop:"16px",marginBottom:"8px"},children:[(0,a.jsx)(s.Button,{variant:"secondary",onClick:()=>{x(!0);try{if(!Array.isArray(B)||0===B.length)return void C((0,o.__)("‚ö° No blocks to zap! Add some blocks inside this container first.","block-zapper-block-wp"));const e="mega"===z,t=E.keepMedia;if(!(console.log("handleZap starting with:",{zapMode:z,isMegaZap:e,keepMedia:t,zapOptions:E}),e||Object.entries(E).some(([e,o])=>"keepMedia"!==e&&!0===o)))return void C((0,o.__)("‚ö†Ô∏è Please select at least one zap option to continue!","block-zapper-block-wp"));const s=((e,o=!1,t=!0)=>{if(!Array.isArray(e)||0===e.length)return{totalZapped:0,zapDetails:[],totalAttributesRemoved:0};console.log("zapBlocks called with:",{isMegaZap:o,keepMedia:t,blockCount:e.length});let s=0;const r=[];let l=0;const a=[];return e.forEach(e=>{if(!e||!e.clientId)return void console.warn("Invalid block in zapBlocks:",e);const n=e.name?e.name.replace("core/",""):"unknown",i=O(e),c=Object.keys(i).length,p=Z(e,o,t);if(!p||!p.cleanBlock)return void console.warn(`Could not create clean block for ${n}`);const d=p.cleanBlock,m=p.removedAttributes||[],u=Object.keys(d.attributes||{}).length,h=c-u;(h>0||m.length>0)&&(a.push({originalId:e.clientId,newBlock:d}),s++,l+=h,r.push({name:n,before:c,after:u,removed:h,removedAttributes:m}))}),a.forEach(({originalId:e,newBlock:o})=>{try{P(e,o)}catch(e){console.error("Error replacing block:",e)}}),{totalZapped:s,zapDetails:r,totalAttributesRemoved:l}})(B,e,t);if(w((new Date).toLocaleTimeString()),console.log("Block Zapper Results (MEGA ZAP ULTIMATE FIX):",{mode:z,isMegaZap:e,keepMediaUsed:t,options:E,totalBlocks:B.length,blocksZapped:s.totalZapped,totalAttributesRemoved:s.totalAttributesRemoved,details:s.zapDetails}),s.totalZapped>0){let r;if(e)r=`üí• MEGA ZAP COMPLETE! Nuked ${s.totalAttributesRemoved} properties from ${s.totalZapped} block(s). `,r+="Only essential content preserved",t&&(r+=" + media"),r+="! üöÄ";else{const e=[];E.blockSettings&&e.push("‚öôÔ∏è settings"),E.blockStyles&&e.push("üé® styles"),E.customProperties&&e.push("üîß properties"),E.customClasses&&e.push("üìù classes"),E.customAnchors&&e.push("‚öì anchors"),E.htmlElements&&e.push("üè∑Ô∏è elements"),r=`‚ö° SELECTIVE ZAP COMPLETE! Removed ${s.totalAttributesRemoved} properties from ${s.totalZapped} block(s). `,r+=`Zapped: ${e.join(", ")}.`,t&&(r+=" üì∏ Media preserved.")}C((0,o.__)(r,"block-zapper-block-wp"))}else{const t=e?"‚ú® No properties found to mega zap! Blocks are already clean.":"‚ú® No matching properties found to zap with your current settings!";C((0,o.__)(t,"block-zapper-block-wp"))}}catch(e){console.error("Zap error:",e),C((0,o.__)("‚ùå Zap failed! Check the console for details: "+(e.message||"Unknown error"),"block-zapper-block-wp"))}x(!1)},isBusy:v,disabled:L.disabled,style:{backgroundColor:v?"#999":L.color,color:"#fff",border:"none",borderRadius:"4px",padding:"12px 24px",fontWeight:"bold",textTransform:"uppercase",fontSize:"16px",width:"100%"},children:L.label}),"selective"===z&&!I&&(0,a.jsx)("p",{style:{fontSize:"12px",color:"#666",marginTop:"8px",textAlign:"center"},children:"Select at least one zap option to enable"}),"mega"===z&&0===_&&(0,a.jsx)("p",{style:{fontSize:"12px",color:"#666",marginTop:"8px",textAlign:"center"},children:"Add blocks to the container to enable mega zap"})]}),y&&(0,a.jsx)(s.Notice,{status:y.includes("COMPLETE")?"success":y.includes("failed")?"error":"info",isDismissible:!0,onRemove:()=>C(""),style:{marginTop:"12px",fontSize:"13px"},children:y})]})}),(0,a.jsx)("div",{...f,children:(0,a.jsx)(t.InnerBlocks,{tmplateLock:!1,renderAppender:t.InnerBlocks.DefaultAppender})})]})}})}},t={};function s(e){var r=t[e];if(void 0!==r)return r.exports;var l=t[e]={exports:{}};return o[e](l,l.exports,s),l.exports}s.m=o,e=[],s.O=(o,t,r,l)=>{if(!t){var a=1/0;for(p=0;p<e.length;p++){for(var[t,r,l]=e[p],n=!0,i=0;i<t.length;i++)(!1&l||a>=l)&&Object.keys(s.O).every(e=>s.O[e](t[i]))?t.splice(i--,1):(n=!1,l<a&&(a=l));if(n){e.splice(p--,1);var c=r();void 0!==c&&(o=c)}}return o}l=l||0;for(var p=e.length;p>0&&e[p-1][2]>l;p--)e[p]=e[p-1];e[p]=[t,r,l]},s.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),(()=>{var e={57:0,350:0};s.O.j=o=>0===e[o];var o=(o,t)=>{var r,l,[a,n,i]=t,c=0;if(a.some(o=>0!==e[o])){for(r in n)s.o(n,r)&&(s.m[r]=n[r]);if(i)var p=i(s)}for(o&&o(t);c<a.length;c++)l=a[c],s.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return s.O(p)},t=globalThis.webpackChunkblock_zapper=globalThis.webpackChunkblock_zapper||[];t.forEach(o.bind(null,0)),t.push=o.bind(null,t.push.bind(t))})();var r=s.O(void 0,[350],()=>s(792));r=s.O(r)})();